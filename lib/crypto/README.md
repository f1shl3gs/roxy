Crypto ported from https://github.com/shadowsocks/crypto2